---
title: "STAT_380_Final_Code"
author: "Andrew Bartnikowski, Zachary Brown, Julian Grossman, Rowan Tolfree"
date: "2025-11-26"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Front Matter - Clean Environment, Load Libraries, Read dataset

```{r}
rm(list = ls())
library(readr)
library(tidyr)
library(dplyr)
library(stringr)
library(ggplot2)
library(forcats)
```

Load in our data sets
```{r}
Modes <- read.csv("CODGameModes.csv")
Player1 <- read.csv("CODGames_p1_380.csv")
Player2 <- read.csv("CODGames_p2_380.csv")
```

## Task 1 -- Exploratory Analysis

Remove hardcore indicators in a separate column to prepare the data for a join on the COD game modes data. I kept the data for each player seperate foe ease of use when trying to compare insights from each. A joint data set will be made soon below.
```{r}
Player1 <- Player1  %>%
  mutate(Mode = str_replace(GameType, "HC - ", ""))

Player2 <- Player2  %>%
  mutate(Mode = str_replace(GameType, "HC - ", ""))
```

Join each players data with the game modes data so we can answer our research question, "Which game mode is most likely to reach the score limit?".
```{r}
Clean_p1 <- Player1 %>%
  left_join(Modes, by = c("Mode" = "Mode"))

Clean_p2 <- Player2 %>%
  left_join(Modes, by = c("Mode" = "Mode"))
```


Need to be able to indentify whether or not score limit has been reached
```{r}
Clean_p1 <- Clean_p1 %>% 
  separate(Result, into = c("PlayerTeam", "OtherTeam"), sep = "-", convert = TRUE) %>% 
  mutate(MaxScore = pmax(PlayerTeam, OtherTeam),
         LimitReached = MaxScore == ScoreLimit) %>% 
  filter(Score != is.na(Score))

Clean_p2 <- Clean_p2 %>% 
  separate(Result, into = c("PlayerTeam", "OtherTeam"), sep = "-", convert = TRUE) %>% 
  mutate(MaxScore = pmax(PlayerTeam, OtherTeam),
         LimitReached = MaxScore == ScoreLimit) %>% 
  filter(Score != is.na(Score))
```


Joined the players to make one large data set to more accurately answer our research question for task 1.
```{r}
Joined_players <- bind_rows(Clean_p1, Clean_p2)
```

Create visualization displaying the game modes and the proportion of them reaching the score limit. Simple bar chart to explain this.
```{r}
ggplot(
  data = Joined_players %>%
    group_by(Mode) %>%
    summarise(
      Pct_limit = mean(LimitReached)
      ),
  mapping = aes(x = Mode, y = Pct_limit)
) + 
  labs(
  title = "Game Modes by Score Limit",
  x = "Game Modes",
  y = "Percentage of Score Limit Reached"
) +
  geom_col(width = 0.5, fill = "lightblue") +
  theme_bw()
```

## Task 2 -- Inference

#### Which predictors are associated with the TotalXP?

##### Convert categorical Variables
```{r}
Joined_players2 <- Joined_players %>%
  # Convert categorical variables to factors
  mutate(
    GameType = as.factor(GameType),
    Mode = as.factor(Mode),
    PrimaryWeapon = as.factor(PrimaryWeapon),
    XPType = as.factor(XPType),
    FullPartial = as.factor(FullPartial),
    DidPlayerVote = as.factor(DidPlayerVote),
    LimitReached = as.factor(LimitReached)
  )
```

There are two different Double XP + 10%. 517 for one and one for the other. So we will merge those 2 as this is most likely a mistake when imputing the data.
```{r}
Joined_players2 <- Joined_players2 %>%
  mutate(
    XPType = fct_collapse(XPType,
                          "Double XP + 10%" = c("Double XP + 10%", "Double XP + 10% "))
  )
```

##### Multiple Linear Regression
```{r}
lm_xp <- lm(
  TotalXP ~ Eliminations + Deaths + Score + Damage +
            GameType + Mode + PrimaryWeapon + XPType +
            FullPartial + DidPlayerVote + LimitReached,
  data = Joined_players2
)

summary(lm_xp)
```

Due to the large number of missing values in the variables Confirms, Denies, Objectives, ObjectiveKills, Captures, Diffuses, Plants, Detonates, Deposits, Time_Sec, and Time_Min, these variables were excluded from the model to avoid loss of data. After running the multiple linear regression, then looking at the p-values denoted by the Pr(>|t|) column, it tells us which predictors are statistically significant predictors for TotalXP. The predictors that will be deemed statistically significant will have a p-value less than 0.05. The predictors that fit this are: Eliminations, Score, Damage, PrimaryWeaponMilano 821, PrimaryWeaponXM4, and XPTypeDouble XP + 10%. These results indicate that TotalXP is primarily driven by player performance metrics and XP multipliers.

#### Of the predictors associated with the response, select one of the predictors and explain the relationship between the predictor and TotalXP.
```{r}
ggplot(Joined_players2, aes(x = XPType, y = TotalXP)) +
  geom_boxplot(fill = "lightblue") +
  labs(
    title = "Effect of XPType on TotalXP",
    x = "XPType",
    y = "TotalXP"
  )
```

The boxplot clearly shows that matches with Double XP result in much higher TotalXP than standard matches. This confirms the model result that XPType is a strong driver of XP gains.
